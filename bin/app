#! /usr/bin/env node --harmony

var co = require('co');
var appFactory = require('../lib/app');
var program = require('commander');

program.usage('./bin/server [options] <profile>');
program.parse(process.argv);

co(function* () {
	var profile = program.args[0];
	profile = profile || 'development';
	var config = require('../config/' + profile);
	var app = yield appFactory(config);
	var server = yield app.listen.bind(app, config.port);
	console.log('server listen', { port: config.port });
})(function(err) {
	if (err) throw err;
});
